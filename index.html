<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Bloody Donut</title>
<link rel="icon" type="image/jpeg" href="favicon.jpg">

<style>
  body {
    margin: 0;
    background: #0d0d0d;
    color: #ffffff;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh;
    text-align: center;
    padding: 20px;
  }

  #date {
    font-size: 14px;
    color: #999;
    margin-bottom: 10px;
  }

  #chapter {
    font-size: 48px;
    font-weight: bold;
    margin-bottom: 10px;
  }

  #tomorrow {
    font-size: 18px;
    color: #aaa;
  }

  /* Mobile optimization */
  @media (max-width: 600px) {
    #chapter {
      font-size: 36px;
    }
    #tomorrow {
      font-size: 16px;
    }
  }

  /* Test date box */
  #tester {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #1a1a1a;
    padding: 10px;
    border-radius: 8px;
    font-size: 14px;
  }

  #tester input {
    background: #000;
    color: white;
    border: 1px solid #555;
    padding: 4px;
    border-radius: 4px;
  }

  #tester button {
    margin-left: 5px;
    padding: 4px 8px;
    background: #222;
    color: white;
    border: 1px solid #444;
    border-radius: 4px;
    cursor: pointer;
  }

  #tester button:hover {
    background: #333;
  }
</style>
</head>
<body>

<div id="date"></div>
<div id="chapter"></div>
<div id="tomorrow"></div>

<!-- Test-date box -->
<div id="tester">
  Test date:
  <input type="date" id="testInput">
  <button onclick="applyTestDate()">Go</button>
</div>

<script>
// Books from Mark → Revelation
const books = [
  ["Mark", 16], ["Luke", 24], ["John", 21], ["Acts", 28],
  ["Romans", 16], ["1 Corinthians", 16], ["2 Corinthians", 13],
  ["Galatians", 6], ["Ephesians", 6], ["Philippians", 4],
  ["Colossians", 4], ["1 Thessalonians", 5], ["2 Thessalonians", 3],
  ["1 Timothy", 6], ["2 Timothy", 4], ["Titus", 3], ["Philemon", 1],
  ["Hebrews", 13], ["James", 5], ["1 Peter", 5], ["2 Peter", 3],
  ["1 John", 5], ["2 John", 1], ["3 John", 1], ["Jude", 1],
  ["Revelation", 22]
];

// Flatten to single list like ["Mark 1", "Mark 2", ...]
let chapters = [];
books.forEach(b => {
  for (let c = 1; c <= b[1]; c++) {
    chapters.push(`${b[0]} ${c}`);
  }
});

// Starting point: Dec 1 → Mark 4
const startIndex = chapters.indexOf("Mark 4");

// Day difference helper
function daysBetween(a, b) {
  const ms = 86400000;
  return Math.round((a - b) / ms);
}

// Finds the Dec 1 anchor for the current or test year
function getAnchor(date) {
  const dec1 = new Date(date.getFullYear(), 11, 1);
  return date < dec1 ? new Date(date.getFullYear() - 1, 11, 1) : dec1;
}

// Get chapter for any date
function getChapterFor(date) {
  const anchor = getAnchor(date);
  const diff = daysBetween(
    new Date(date.getFullYear(), date.getMonth(), date.getDate()),
    anchor
  );
  const idx = (startIndex + diff) % chapters.length;
  return chapters[(idx + chapters.length) % chapters.length];
}

// MAIN DISPLAY
function display(date) {
  document.getElementById("date").textContent = date.toDateString();

  const todayChapter = getChapterFor(date);
  document.getElementById("chapter").textContent = todayChapter;

  // Tomorrow
  const tomorrow = new Date(date);
  tomorrow.setDate(tomorrow.getDate() + 1);
  const tomorrowChapter = getChapterFor(tomorrow);
  document.getElementById("tomorrow").textContent =
    "Tomorrow: " + tomorrowChapter;
}

// Test date handler
function applyTestDate() {
  const val = document.getElementById("testInput").value;
  if (!val) return;
  display(new Date(val));
}

// Default: show today
display(new Date());
</script>

</body>
</html>
